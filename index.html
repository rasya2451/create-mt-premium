<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MT Generator VIP Premium</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-slate-900 text-white flex justify-center items-start p-6">

  <div class="w-full max-w-3xl space-y-6">

    <!-- Login Card -->
    <div id="authCard" class="bg-white/10 backdrop-blur-md p-6 rounded-2xl shadow-lg space-y-3">
      <h2 class="text-2xl font-bold text-center">Login</h2>
      <input id="username" placeholder="Username" class="w-full p-3 rounded-xl bg-white/20 focus:outline-none"/>
      <input id="token" placeholder="Token" class="w-full p-3 rounded-xl bg-white/20 focus:outline-none"/>
      <button id="loginBtn" class="w-full py-2 rounded-xl bg-indigo-500 hover:bg-indigo-600 font-semibold">Login</button>
    </div>

    <!-- Dashboard -->
    <div id="profileCard" class="hidden bg-white/10 backdrop-blur-md p-6 rounded-2xl shadow-lg space-y-4">
      <div class="flex justify-between items-center">
        <div>
          <h3 id="profileName" class="text-xl font-bold"></h3>
          <p id="profileUID" class="text-sm opacity-70"></p>
          <p id="profileRegion" class="text-sm opacity-70"></p>
        </div>
        <button id="logoutBtn" class="px-4 py-2 bg-red-500 hover:bg-red-600 rounded-xl font-semibold">Logout</button>
      </div>

      <!-- Owner Only -->
      <div id="ownerControls" class="hidden grid gap-4">
        <div class="bg-white/5 p-4 rounded-xl space-y-2">
          <h4 class="font-semibold">Upload MT Band</h4>
          <textarea id="ownerMT" placeholder="Masukkan MT Band" class="w-full p-2 rounded-xl bg-white/20"></textarea>
          <button id="uploadMTBtn" class="w-full py-2 bg-red-500 hover:bg-red-600 rounded-xl font-semibold">Upload</button>
        </div>

        <div class="bg-white/5 p-4 rounded-xl space-y-2">
          <h4 class="font-semibold">Create User</h4>
          <input id="newUsername" placeholder="Username baru" class="w-full p-2 rounded-xl bg-white/20"/>
          <input id="newToken" placeholder="Token baru" class="w-full p-2 rounded-xl bg-white/20"/>
          <button id="createUserBtn" class="w-full py-2 bg-green-500 hover:bg-green-600 rounded-xl font-semibold">Create</button>
        </div>

        <div class="bg-white/5 p-4 rounded-xl space-y-2">
          <h4 class="font-semibold">Tambah Lagu</h4>
          <input id="songTitle" placeholder="Judul Lagu" class="w-full p-2 rounded-xl bg-white/20"/>
          <input id="songLink" placeholder="Link Catbox (mp3)" class="w-full p-2 rounded-xl bg-white/20"/>
          <button id="addSongBtn" class="w-full py-2 bg-blue-500 hover:bg-blue-600 rounded-xl font-semibold">Tambah Lagu</button>
        </div>
      </div>

      <!-- Generate MT -->
      <form id="genForm" class="space-y-2">
        <input id="uid" placeholder="UID" class="w-full p-2 rounded-xl bg-white/20"/>
        <select id="region" class="w-full p-2 rounded-xl bg-white/20">
          <option value="ID">Indonesia</option>
          <option value="SG">Singapore</option>
          <option value="US">USA</option>
        </select>
        <button class="w-full py-2 bg-indigo-500 hover:bg-indigo-600 rounded-xl font-semibold">Generate</button>
      </form>

      <!-- Result -->
      <div id="mtBandResult" class="hidden bg-white/5 rounded-xl p-3 flex justify-between items-center">
        <span id="mtBandText" class="text-sm">—</span>
        <button id="copyMTBand" class="px-3 py-1 bg-indigo-500 hover:bg-indigo-600 rounded-xl text-xs font-semibold">Copy</button>
      </div>

      <!-- Playlist -->
      <div class="bg-white/5 p-4 rounded-xl space-y-2">
        <h4 class="font-semibold">Playlist</h4>
        <ul id="playlist" class="space-y-2"></ul>
      </div>
    </div>
  </div>

  <audio id="audioPlayer" controls class="hidden"></audio>

  <script>
    const OWNER_USERNAME="admin",OWNER_TOKEN="242410";
    const $=s=>document.querySelector(s);
    const toast=msg=>alert(msg);
    const saveUser=u=>localStorage.setItem("currentUser",JSON.stringify(u));
    const getUser=()=>JSON.parse(localStorage.getItem("currentUser")||"null");
    const logout=()=>{localStorage.removeItem("currentUser");location.reload();};

    function login(username,token){
      if(username===OWNER_USERNAME&&token===OWNER_TOKEN){
        saveUser({username,token,isOwner:true}); showProfile({username,token,isOwner:true}); return;
      }
      const users=JSON.parse(localStorage.getItem("users")||"[]");
      const f=users.find(u=>u.username===username&&u.token===token);
      if(f){saveUser({username,token,isOwner:false});showProfile({username,token,isOwner:false});}
      else toast("User belum terdaftar!");
    }

    function showProfile(user){
      $("#profileName").textContent=user.username;
      $("#profileUID").textContent="UID: —";
      $("#profileRegion").textContent="Region: —";
      $("#authCard").classList.add("hidden");
      $("#profileCard").classList.remove("hidden");
      if(user.isOwner) $("#ownerControls").classList.remove("hidden");
      else $("#ownerControls").classList.add("hidden");
      renderPlaylist(user.isOwner);
    }

    $("#loginBtn").onclick=()=>login($("#username").value.trim(),$("#token").value.trim());
    $("#logoutBtn").onclick=logout;

    $("#uploadMTBtn")?.addEventListener("click",()=>{
      const t=$("#ownerMT").value.trim(); if(!t)return toast("MT kosong!");
      $("#mtBandText").textContent=t; $("#mtBandResult").classList.remove("hidden"); toast("MT Uploaded!");
    });

    $("#createUserBtn")?.addEventListener("click",()=>{
      const u=$("#newUsername").value.trim(),t=$("#newToken").value.trim();
      if(!u||!t)return toast("Isi username+token!");
      let users=JSON.parse(localStorage.getItem("users")||"[]");
      if(users.find(x=>x.username===u))return toast("Username sudah ada!");
      users.push({username:u,token:t}); localStorage.setItem("users",JSON.stringify(users)); toast("User dibuat!");
    });

    const getSongs=()=>JSON.parse(localStorage.getItem("songs")||"[]");
    const saveSongs=s=>localStorage.setItem("songs",JSON.stringify(s));

    function renderPlaylist(isOwner){
      const songs=getSongs(),pl=$("#playlist"); pl.innerHTML="";
      songs.forEach((song,i)=>{
        const li=document.createElement("li"); li.className="flex justify-between items-center bg-slate-800 rounded-xl p-3";
        li.innerHTML=`<div><p class="font-semibold">${song.title}</p><p class="text-xs opacity-70">${song.link}</p></div>
        <div class="flex gap-2">
          <button class="px-2 py-1 bg-indigo-500 hover:bg-indigo-600 rounded-lg text-xs font-semibold playBtn">Play</button>
          ${isOwner?`<button class="px-2 py-1 bg-yellow-500 hover:bg-yellow-600 rounded-lg text-xs font-semibold editBtn">Edit</button>
          <button class="px-2 py-1 bg-red-500 hover:bg-red-600 rounded-lg text-xs font-semibold deleteBtn">Hapus</button>`:""}
        </div>`;
        li.querySelector(".playBtn").onclick=()=>{const a=$("#audioPlayer");a.src=song.link;a.play();toast("Play: "+song.title);};
        if(isOwner){
          li.querySelector(".editBtn").onclick=()=>{const nt=prompt("Judul:",song.title)||song.title; const nl=prompt("Link:",song.link)||song.link; songs[i]={title:nt,link:nl}; saveSongs(songs); renderPlaylist(true);};
          li.querySelector(".deleteBtn").onclick=()=>{songs.splice(i,1); saveSongs(songs); renderPlaylist(true);};
        }
        pl.appendChild(li);
      });
    }

    $("#addSongBtn")?.addEventListener("click",()=>{
      const t=$("#songTitle").value.trim(),l=$("#songLink").value.trim();
      if(!t||!l)return toast("Isi judul+link!");
      const s=getSongs(); s.push({title:t,link:l}); saveSongs(s); renderPlaylist(true);
      $("#songTitle").value="";$("#songLink").value=""; toast("Lagu ditambahkan!");
    });

    function genMT(uid){const r=["Pelanggaran","Modifikasi","Aktivitas mencurigakan","Spam","Melanggar TOS"];return `MT-BAND-${uid}-${Math.floor(1000+Math.random()*9000)} (${r[Math.floor(Math.random()*r.length)]})`;}
    $("#genForm").onsubmit=e=>{e.preventDefault(); const uid=$("#uid").value.trim(); $("#mtBandText").textContent=genMT(uid); $("#mtBandResult").classList.remove("hidden");};
    $("#copyMTBand").onclick=()=>{navigator.clipboard.writeText($("#mtBandText").textContent); toast("Copied!");};

    const saved=getUser(); if(saved)showProfile(saved);
  </script>
</body>
</html>
